(self.webpackChunkNFBWebPlayer=self.webpackChunkNFBWebPlayer||[]).push([[275],{3976:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>b});var i=n(6610),o=n(5991),r=n(3349),a=n(7608);function s(t,e,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=(0,a.Z)(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}var u=n(379),l=n(6070),c=n(6507),d=n(7361),h=n.n(d),p=n(3493),f=n.n(p),v=n(9669),g=n.n(v);function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,a.Z)(t);if(e){var o=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,l.Z)(this,n)}}var P=c.default.getPlugin("plugin"),m={sourceSlug:null,embedMode:null,sourceURL:null,unstatURL:null,fromIP:null,sessionID:null,platform:null,context:null,apiKey:null,user:null},E=function(t){(0,u.Z)(n,t);var e=y(n);function n(t,o){var a;return(0,i.Z)(this,n),(a=e.call(this,t)).log.level(c.default.log.level()),a.options=c.default.mergeOptions(m,o),a.checkRequiredOptions()?(a.initDuration=a.initDuration.bind((0,r.Z)(a)),a.initFirstPlay=a.initFirstPlay.bind((0,r.Z)(a)),a.onFirstPlay=a.onFirstPlay.bind((0,r.Z)(a)),a.onTimeUpdate=f()(a.onTimeUpdate.bind((0,r.Z)(a)),5e3),a.onEnded=a.onEnded.bind((0,r.Z)(a)),a.onPause=a.onPause.bind((0,r.Z)(a)),a.onLeave=a.onLeave.bind((0,r.Z)(a)),a.totalDuration=0,a.currentPercent=0,a.state={firstPlay:!1,firstQuartile:!1,secondQuartile:!1,thirdQuartile:!1,almostEnded:!1,ended:!1},a.player.ready(a.initFirstPlay),a.player.on("loadeddata",a.initDuration),a):(a.dispose(),(0,l.Z)(a))}return(0,o.Z)(n,[{key:"checkRequiredOptions",value:function(){return h()(this.options,"sourceSlug")?!!h()(this.options,"sourceURL")||(this.log.error("Source URL needs to be defined."),!1):(this.log.error("Source slug needs to be defined."),!1)}},{key:"initFirstPlay",value:function(){this.log("Init First Play"),this.player.options().autoplay?this.onAutoPlay():this.player.one("play",this.onFirstPlay)}},{key:"initDuration",value:function(){this.log("Init Duration"),this.totalDuration=this.player.duration().toFixed(0),this.player.on("ended",this.onEnded),this.player.on("pause",this.onPause),this.player.on("timeupdate",this.onTimeUpdate),window.addEventListener("unload",this.onLeave),this.sendGtagEvent("Estimated Duration","Video - ".concat(this.options.sourceSlug," ").concat(this.totalDuration," Embed_mode: ").concat(this.options.embedMode?"True":"False"))}},{key:"onTimeUpdate",value:function(){this.currentPercent=this.player.currentTime().toFixed(0)/this.totalDuration,this.currentPercent>=.25&&!this.state.firstQuartile?this.onFirstQuartile():this.currentPercent>=.5&&!this.state.secondQuartile?this.onSecondQuartile():this.currentPercent>=.75&&!this.state.thirdQuartile?this.onThirdQuartile():this.currentPercent>=.95&&!this.state.almostEnded&&this.onAlmostEnded()}},{key:"onFirstPlay",value:function(){this.log("On First Play"),this.sendUnstatEvent("play-control","start"),this.sendGtagEvent("Play","Video - ".concat(this.options.sourceSlug))}},{key:"onAutoPlay",value:function(){this.log("On Auto Play"),this.sendUnstatEvent("play-control","start"),this.sendGtagEvent("Auto Play","Video - ".concat(this.options.sourceSlug))}},{key:"onFirstQuartile",value:function(){this.log("On First Quartile"),this.state.firstQuartile=!0,this.sendUnstatEvent("percent-point-reach",25),this.sendGtagEvent("Percent Point Reach","Video - ".concat(this.options.sourceSlug," 25"))}},{key:"onSecondQuartile",value:function(){this.log("On Second Quartile"),this.state.secondQuartile=!0,this.sendUnstatEvent("percent-point-reach",50),this.sendGtagEvent("Percent Point Reach","Video - ".concat(this.options.sourceSlug," 50"))}},{key:"onThirdQuartile",value:function(){this.log("On Third Quartile"),this.state.thirdQuartile=!0,this.sendUnstatEvent("percent-point-reach",75),this.sendGtagEvent("Percent Point Reach","Video - ".concat(this.options.sourceSlug," 75"))}},{key:"onAlmostEnded",value:function(){this.log("On Almost Ended"),this.state.almostEnded=!0,this.sendUnstatEvent("percent-point-reach",95),this.sendGtagEvent("Percent Point Reach","Video - ".concat(this.options.sourceSlug," 95"))}},{key:"onEnded",value:function(){this.log("On Ended"),this.state.ended=!0,this.sendUnstatEvent("percent-point-reach",100),this.sendGtagEvent("Percent Point Reach","Video - ".concat(this.options.sourceSlug," 100"))}},{key:"onPause",value:function(){this.log("On Pause"),this.player.seeking()?this.sendGtagEvent("View Duration","Video - ".concat(this.options.sourceSlug," seek ").concat(this.player.currentTime().toFixed(0))):this.sendGtagEvent("View Duration","Video - ".concat(this.options.sourceSlug," pause ").concat(this.player.currentTime().toFixed(0)))}},{key:"onLeave",value:function(){this.log("On Leave"),this.sendGtagEvent("View Duration","Video - ".concat(this.options.sourceSlug," exit ").concat(this.player.currentTime().toFixed(0)))}},{key:"sendUnstatEvent",value:function(t,e){var n=this;this.log("Send unstat event : ".concat(t," - ").concat(e)),this.options.unstatURL&&t&&e||this.log.warn("Unable to send unstat event");var i="".concat(this.options.unstatURL).concat(t,"/"),o=new FormData;o.append("url",this.options.sourceURL),o.append("event_type",t),o.append("event_value",e),o.append("from_ip",this.options.fromIP),o.append("sessionid",this.options.sessionID),o.append("platform",this.options.platform),o.append("context",this.options.context),o.append("api_key",this.options.apiKey),o.append("user",this.options.user),o.append("comment",""),g().post(i,o).catch((function(t){n.log.error(t)}))}},{key:"sendGtagEvent",value:function(t,e){this.log("Send gtab event : ".concat(t," - ").concat(e)),window.gtag?window.gtag("event",t,{event_category:"Video",event_label:e}):this.log.warn("Unable to send gtag event")}},{key:"dispose",value:function(){window.removeEventListener("unload",this.onLeave),s((0,a.Z)(n.prototype),"dispose",this).call(this)}}]),n}(P);E.defaultState={},E.VERSION="1.0.0",c.default.registerPlugin("nfbStat",E);const b=E},7561:(t,e,n)=>{var i=n(7990),o=/^\s+/;t.exports=function(t){return t?t.slice(0,i(t)+1).replace(o,""):t}},7990:t=>{var e=/\s/;t.exports=function(t){for(var n=t.length;n--&&e.test(t.charAt(n)););return n}},3279:(t,e,n)=>{var i=n(3218),o=n(7771),r=n(4841),a=Math.max,s=Math.min;t.exports=function(t,e,n){var u,l,c,d,h,p,f=0,v=!1,g=!1,y=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function P(e){var n=u,i=l;return u=l=void 0,f=e,d=t.apply(i,n)}function m(t){return f=t,h=setTimeout(b,e),v?P(t):d}function E(t){var n=t-p;return void 0===p||n>=e||n<0||g&&t-f>=c}function b(){var t=o();if(E(t))return k(t);h=setTimeout(b,function(t){var n=e-(t-p);return g?s(n,c-(t-f)):n}(t))}function k(t){return h=void 0,y&&u?P(t):(u=l=void 0,d)}function w(){var t=o(),n=E(t);if(u=arguments,l=this,p=t,n){if(void 0===h)return m(p);if(g)return clearTimeout(h),h=setTimeout(b,e),P(p)}return void 0===h&&(h=setTimeout(b,e)),d}return e=r(e)||0,i(n)&&(v=!!n.leading,c=(g="maxWait"in n)?a(r(n.maxWait)||0,e):c,y="trailing"in n?!!n.trailing:y),w.cancel=function(){void 0!==h&&clearTimeout(h),f=0,u=p=l=h=void 0},w.flush=function(){return void 0===h?d:k(o())},w}},7771:(t,e,n)=>{var i=n(5639);t.exports=function(){return i.Date.now()}},3493:(t,e,n)=>{var i=n(3279),o=n(3218);t.exports=function(t,e,n){var r=!0,a=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return o(n)&&(r="leading"in n?!!n.leading:r,a="trailing"in n?!!n.trailing:a),i(t,e,{leading:r,maxWait:e,trailing:a})}},4841:(t,e,n)=>{var i=n(7561),o=n(3218),r=n(3448),a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,u=/^0o[0-7]+$/i,l=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(r(t))return NaN;if(o(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=o(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=i(t);var n=s.test(t);return n||u.test(t)?l(t.slice(2),n?2:8):a.test(t)?NaN:+t}}}]);
//# sourceMappingURL=videojs-nfb-unstat.7e5bc167596dff2701ab.js.map