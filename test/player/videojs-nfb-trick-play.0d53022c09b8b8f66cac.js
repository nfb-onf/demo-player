(self.webpackChunkNFBWebPlayer=self.webpackChunkNFBWebPlayer||[]).push([[791],{1829:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>w});var n=r(484);function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function i(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var o=r(4665),u=r(2137),s=r(6610),c=r(5991),l=r(379),f=r(6070),p=r(7608),h=r(7757),g=r.n(h),m=r(9669),y=r.n(m),d=r(6507);function v(){v=function(t,e){return new r(t,void 0,e)};var t=RegExp.prototype,e=new WeakMap;function r(t,n,a){var i=new RegExp(t,n);return e.set(i,a||e.get(t)),(0,o.Z)(i,r.prototype)}function a(t,r){var n=e.get(r);return Object.keys(n).reduce((function(e,r){return e[r]=t[n[r]],e}),Object.create(null))}return(0,l.Z)(r,RegExp),r.prototype.exec=function(e){var r=t.exec.call(this,e);return r&&(r.groups=a(r,this)),r},r.prototype[Symbol.replace]=function(r,i){if("string"==typeof i){var o=e.get(this);return t[Symbol.replace].call(this,r,i.replace(/\$<([^>]+)>/g,(function(t,e){return"$"+o[e]})))}if("function"==typeof i){var u=this;return t[Symbol.replace].call(this,r,(function(){var t=arguments;return"object"!==(0,n.Z)(t[t.length-1])&&(t=[].slice.call(t)).push(a(t,u)),i.apply(this,t)}))}return t[Symbol.replace].call(this,r,i)},v.apply(this,arguments)}function b(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=(0,p.Z)(t);if(e){var a=(0,p.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,f.Z)(this,r)}}var I=d.default.getPlugin("plugin"),S={source:null},x=function(t){(0,l.Z)(f,t);var e,n,a,o=b(f);function f(t,e){var r;return(0,s.Z)(this,f),(r=o.call(this,t)).log.level(d.default.log.level()),r.options=d.default.mergeOptions(S,e),r.sprites=[],r.basePath=r.options.source.substring(0,r.options.source.lastIndexOf("/"))+"/",r.imagePathPrefix="",r.init(),r}return(0,c.Z)(f,[{key:"init",value:(a=(0,u.Z)(g().mark((function t(){var e,n,a,i=this;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.log("Initializing NFB Trick Play plugin"),t.prev=1,t.next=4,this.loadSourceM3u8(this.options.source);case 4:return e=t.sent,n=this.getImageStreamURI(e),t.next=8,this.loadImageStreamM3u8(n);case 8:a=t.sent,this.sprites=this.getSpritesFromImageStream(a),this.log("Sprites",this.sprites),this.sprites.length&&this.player.ready((function(){r.e(143).then(r.bind(r,9155)).then((function(){i.player.thumbnailSprite({sprites:i.sprites})}))})),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(1),this.log(t.t0.message);case 17:case"end":return t.stop()}}),t,this,[[1,14]])}))),function(){return a.apply(this,arguments)})},{key:"loadSourceM3u8",value:(n=(0,u.Z)(g().mark((function t(e){return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.log("Loading source file"),t.abrupt("return",y().get(e).then((function(t){return t.data})).catch((function(t){return"Unable to load source file: ".concat(t,".")})));case 2:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"getImageStreamURI",value:function(t){this.log("Get Image Stream URI");var e=t.match(/#EXT-X-IMAGE-STREAM-INF:.*,URI="(.*)"/);if(!e)throw new Error("No image stream URI found");var r=e[1];return this.imagePathPrefix=r.substring(0,r.lastIndexOf("/"))+"/",this.basePath+r}},{key:"loadImageStreamM3u8",value:(e=(0,u.Z)(g().mark((function t(e){return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.log("Loading image stream file"),t.abrupt("return",y().get(e).then((function(t){return t.data})).catch((function(t){return"Unable to load image stream file: ".concat(t,".")})));case 2:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"getSpritesFromImageStream",value:function(t){var e=this;this.log("Get sprites from image stream");var r=v(/(#EXTINF:([\.0-9]*),\n#EXT\x2DX\x2DTILES:RESOLUTION=([0-9]*)x([0-9]*),LAYOUT=([0-9]*)x([0-9]*),DURATION=([\.0-9]*)\n(.*\.jpg))/g,{duration:2,width:3,height:4,interval:7,filename:8});return i(t.matchAll(r)).map((function(t,r){return{url:e.basePath+e.imagePathPrefix+t.groups.filename,start:r*t.groups.duration,duration:parseInt(t.groups.duration),interval:parseInt(t.groups.interval),width:parseInt(t.groups.width),height:parseInt(t.groups.height)}}))}}]),f}(I);x.defaultState={},x.VERSION="1.0.0",d.default.registerPlugin("nfbTrickPlay",x);const w=x}}]);
//# sourceMappingURL=videojs-nfb-trick-play.0d53022c09b8b8f66cac.js.map